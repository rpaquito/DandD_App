{% extends "base.html" %}

{% block title %}Mapa - {{ quest.titulo }}{% endblock %}

{% block extra_css %}
<style>
    @media print {
        .no-print { display: none !important; }
        body { background: white !important; color: black !important; }
        .map-container { border: 2px solid #000 !important; }
        .map-ascii { color: black !important; }
    }

    .map-container {
        background: #fdf1dc;
        border: 3px solid #58170D;
        padding: 20px;
    }

    .map-ascii {
        font-family: 'Courier New', monospace;
        font-size: 12px;
        line-height: 1.2;
        white-space: pre;
        color: #2c1810;
        background: #fdf1dc;
        padding: 15px;
        border: 1px solid #8B4513;
    }

    .map-legend-print {
        font-family: 'Georgia', serif;
        color: #000000;
        background: #fdf1dc;
        padding: 15px;
        border: 1px solid #8B4513;
        margin-top: 20px;
    }

    .map-legend-print strong {
        color: #000000;
    }

    .map-legend-print li {
        color: #000000;
    }

    .map-title {
        font-family: 'Georgia', serif;
        color: #58170D;
        text-align: center;
        font-size: 1.5rem;
        margin-bottom: 15px;
        border-bottom: 2px solid #58170D;
        padding-bottom: 10px;
    }

    .room-key {
        columns: 2;
        column-gap: 30px;
    }

    .room-key li {
        break-inside: avoid;
        margin-bottom: 5px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="no-print mb-4">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{{ url_for('main.index') }}">InÃ­cio</a></li>
                <li class="breadcrumb-item"><a href="{{ url_for('quest.overview', quest_id=quest.id) }}">{{ quest.titulo }}</a></li>
                <li class="breadcrumb-item active">Mapa</li>
            </ol>
        </nav>

        <h1><i class="bi bi-map me-2"></i>Mapa da Aventura</h1>
        <p class="text-muted">{{ quest.titulo }} - Mapa para impressÃ£o</p>
        <button class="btn btn-primary" onclick="window.print()">
            <i class="bi bi-printer me-1"></i>Imprimir Mapa
        </button>
    </div>

    <!-- Mapa ImprimÃ­vel -->
    <div class="map-container">
        <div class="map-title">{{ quest.titulo }}</div>

        <div class="map-ascii">
                              ENTRADA
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                         â”‚
                    â”‚    1. CORREDOR DE       â”‚
                    â”‚       ENTRADA           â”‚
                    â”‚         â˜†               â”‚
                    â”‚                         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚   PUZZLE DA   â”‚
                         â”‚     PORTA     â”‚
                         â”‚      [5]      â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                        â”‚                        â”‚
        â”‚                        â”‚                        â”‚
   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
   â”‚ NICHO   â”‚            â”‚             â”‚            â”‚  NICHO  â”‚
   â”‚   A     â”‚            â”‚  6. CÃ‚MARA  â”‚            â”‚    B    â”‚
   â”‚  [â˜ ]    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚     DOS     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   [â˜ ]   â”‚
   â”‚         â”‚            â”‚  GUARDIÃ•ES  â”‚            â”‚         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚    â˜  â˜  â˜  â˜   â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚             â”‚
                          â”‚     [7]     â”‚
                          â”‚   TomÃ¡s     â”‚
                          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                         â”‚
                    â”‚   8. CORREDOR DAS       â”‚
                    â”‚      ARMADILHAS         â”‚
                    â”‚   â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘     â”‚
                    â”‚         [T]             â”‚
                    â”‚                         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                  â”‚                  â”‚
         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
         â”‚         â”‚      â”‚             â”‚     â”‚         â”‚
         â”‚ TESOURO â”‚      â”‚ 9. CÃ‚MARA   â”‚     â”‚ ALTAR   â”‚
         â”‚  FALSO  â”‚      â”‚  DA RAINHA  â”‚     â”‚ ANTIGO  â”‚
         â”‚   [T]   â”‚      â”‚     ğŸ‘»      â”‚     â”‚         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   Leonor    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                         â”‚
                    â”‚                         â”‚
                    â”‚    10. SALA DO TRONO    â”‚
                    â”‚                         â”‚
                    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
                    â”‚     â”‚    TRONO    â”‚     â”‚
                    â”‚     â”‚             â”‚     â”‚
                    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
                    â”‚                         â”‚
                    â”‚          ğŸ‘‘             â”‚
                    â”‚   CAVALEIRO FANTASMA    â”‚
                    â”‚                         â”‚
                    â”‚  [ALTAR]          [11]  â”‚
                    â”‚                         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        </div>

        <!-- Legenda -->
        <div class="map-legend-print">
            <h5 style="color: #000000; border-bottom: 1px solid #000000; padding-bottom: 5px;">Legenda</h5>
            <div class="row">
                <div class="col-6">
                    <strong>SÃ­mbolos:</strong>
                    <ul class="list-unstyled mt-2">
                        <li>â˜† - Entrada/SaÃ­da</li>
                        <li>â˜  - Esqueleto</li>
                        <li>ğŸ‘» - Fantasma (aliado)</li>
                        <li>ğŸ‘‘ - Boss (Cavaleiro)</li>
                        <li>[T] - Armadilha</li>
                        <li>â–‘ - Ladrilhos de pressÃ£o</li>
                    </ul>
                </div>
                <div class="col-6">
                    <strong>Salas:</strong>
                    <ul class="list-unstyled mt-2 room-key">
                        {% for step in quest.passos %}
                        {% if step.id >= 5 and step.id <= 11 %}
                        <li><strong>{{ step.id }}.</strong> {{ step.titulo }}</li>
                        {% endif %}
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Notas para o Mestre (nÃ£o imprime) -->
    <div class="card bg-dark border-secondary mt-4 no-print">
        <div class="card-header border-secondary">
            <h5 class="mb-0"><i class="bi bi-info-circle me-2"></i>Notas do Mapa para o Mestre</h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <h6 class="text-warning">Armadilhas</h6>
                    <ul>
                        <li><strong>Puzzle da Porta [5]:</strong> Espada â†’ Livro â†’ Moeda â†’ Coruja</li>
                        <li><strong>Corredor [8]:</strong> PadrÃ£o seguro: claro-escuro-claro-claro-escuro</li>
                        <li><strong>Tesouro Falso:</strong> Dardos envenenados se abrir sem verificar</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <h6 class="text-danger">Encontros</h6>
                    <ul>
                        <li><strong>CÃ¢mara dos GuardiÃµes:</strong> 4 Esqueletos (CR 1/4 cada)</li>
                        <li><strong>Sala do Trono:</strong> Cavaleiro Fantasma (CR 3)</li>
                    </ul>
                    <h6 class="text-success mt-3">Aliados</h6>
                    <ul>
                        <li><strong>TomÃ¡s:</strong> Escondido na sala 6/7</li>
                        <li><strong>Rainha Leonor:</strong> Fantasma aliado na sala 9</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
